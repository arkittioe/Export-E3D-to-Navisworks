# ๐๏ธ Export E3D to Navisworks โ AVEVA Automation Tool

<p dir="rtl">
ุงู ูพุฑูฺู ฺฉ ูุฑูโุงูุฒุงุฑ ุฏุณฺฉุชุงูพ ุญุฑููโุง ุจุฑ ูพุงู <b>PyQt6</b> ุงุณุช ฺฉู ูุฑุขูุฏ ุงฺฉุณูพูุฑุช ูุฏูโูุง ุงุฒ <b>AVEVA E3D</b> ุจู <b>Autodesk Navisworks (.nwd)</b> ุฑุง ุจูโุตูุฑุช ฺฉุงููุงู ุฎูุฏฺฉุงุฑ ูุฏุฑุช ูโฺฉูุฏ.
ุจุง ุงู ุงุจุฒุงุฑ ุฏฺฏุฑ ูุงุฒ ุจู ุงุฌุฑุง ุฏุณุช ูุงฺฉุฑููุง ุง ุงุณฺฉุฑูพุชโูุง ุฏุฑ E3D ูุณุช โ ููู ูุงูโูุง ุจุง ฺฉ ฺฉูฺฉ ุณุงุฎุชู ู ุงุฌุฑุง ูโุดููุฏ.
</p>

---

## โจ ุงูฺฉุงูุงุช ฺฉูุฏ

<p dir="rtl">

- ๐จ ุฑุงุจุท ฺฏุฑุงูฺฉ ูุฏุฑู ุจุง ุฏู ุชู <b>Light</b> ู <b>Dark</b>.
- ๐๏ธ ุชููุฏ ุฎูุฏฺฉุงุฑ ด ูุงู ุญุงุช ูพุฑูฺู:
  - `settings.json`  
  - `RVM.mac`  
  - `attribute.mac`  
  - `RunE3D.bat`
- โ๏ธ ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ูุงฺฉุฑู ุฏุฑ <b>AVEVA Everything3D</b> ุงุฒ ุทุฑู `RunE3D.bat`.
- ๐ ูพุงฺฉโุณุงุฒ ุฎูุฏฺฉุงุฑ ุชูุงู ูุงูโูุง ูููุช ูพุณ ุงุฒ ุงุชูุงู ููููุชโุขูุฒ ุงฺฉุณูพูุฑุช NWD.
- ๐ ูพูู ุฌุงูุจ ุดูุงูุฑ ุจุฑุง ูุฏุฑุช ูุณุช ุขุจุฌฺฉุชโูุง (ุฏุฑ ุตูุฑุช ูุจูุฏ `SITE.txt`).
- ๐พ ุฐุฎุฑู ู ุจุงุฒุงุจ ุชูุธูุงุช ฺฉุงุฑุจุฑ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุง `QSettings`.
- ๐ ุงูฺฉุงู ุงุฌุฑุง ููุธู ู ุฒูุงูโุจูุฏโุดุฏู ุฑูุฒุงูู.
- ๐งฉ ูพุดุชุจุงู ุงุฒ ูุณุชโูุง ูพุฑูฺูโุง ูพุดโูุฑุถ (PAZ, PBZ, PCZ, PFB, PEZ, PMZ, ...).
- ๐ ุงุนุชุจุงุฑุณูุฌ ฺฉุงูู ูุฑูุฏโูุง ู ูุณุฑูุง.
- ๐ ููุงุด ูพูุฌุฑูโ ยซุฏุฑุจุงุฑูยป ุจุง ุงุทูุงุนุงุช ูุณุฎู ู ุชูุณุนูโุฏููุฏู.

</p>

---

## ๐งฉ ุณุงุฎุชุงุฑ ุจุฑูุงูู

<p dir="rtl">

ุจุฑูุงูู ุดุงูู ูพูุฌ ุจุฎุด ุงุตู ุงุณุช:

1. **ุฑุงุจุท ฺฉุงุฑุจุฑ (GUI):**  
   ุทุฑุงุญโุดุฏู ุจุง `QMainWindow` ู ฺฏุฑููโุจูุฏโุดุฏู ุฏุฑ ุจุฎุดโูุง ุชูุธูุงุชุ ูุณุฑูุง ู ุฎุฑูุฌโูุง.  
   ุฏุงุฑุง ฺฉูุชุฑูโูุง:
   - ูุณุฑูุง AVEVA ู Navisworks  
   - ุงุทูุงุนุงุช ูพุฑูฺู ู MDB  
   - ูุงู ูุณุช ุขุจุฌฺฉุช ุง ูพูู ุฏุณุช  

2. **ูพูู ุฌุงูุจ (Side Panel):**  
   ุจุฎุด ุจุง ุนุฑุถ 300px ฺฉู ุจุง ุงููุดู ุจุงุฒ/ุจุณุชู ูโุดูุฏ.  
   ุขุจุฌฺฉุชโูุง ุฑุง ุงุฒ ูุงู `SITE.txt` ุง ูุณุช ูพุดโูุฑุถ ูพุฑูฺู (ูุซู `PAZ`, `PBZ`, `PEZ`...) ูโฺฏุฑุฏ.  
   ฺฉุงุฑุจุฑ ูโุชูุงูุฏ ุงููุงู ุฑุง **ุงูุฒูุฏู / ุญุฐู / ูพุงฺฉโุณุงุฒ** ฺฉูุฏ.

3. **ุชููุฏ ูุงูโูุง:**  
   ุชุงุจุน ุงุตู `generate_files()` ุจุง ุชูุฌู ุจู ูุฑูุฏโูุงุ ฺูุงุฑ ูุงู ุฒุฑ ุฑุง ุฏุฑ ูุณุฑ ุฎุฑูุฌ ุชููุฏ ูโฺฉูุฏ:
   - `settings.json` โ ุฌุฒุฆุงุช ุชูุธูุงุช ฺฉุงุฑุจุฑ  
   - `attribute.mac` โ ูุงฺฉุฑู ุงุณุชุฎุฑุงุฌ Attributes  
   - `RVM.mac` โ ูุงฺฉุฑู ุงฺฉุณูพูุฑุช RVM ู ุชุจุฏู ุจู NWD  
   - `RunE3D.bat` โ ุงุฌุฑุง ุฎูุฏฺฉุงุฑ AVEVA ุจุง ูุงฺฏโฺฏุฑ ู ูพุงฺฉโุณุงุฒ

4. **ุงุฌุฑุง ุฎูุฏฺฉุงุฑ Batch Script:**  
   ูพุณ ุงุฒ ุณุงุฎุช ูุงูโูุงุ ุจุฑูุงูู ุจูุงูุงุตูู `RunE3D.bat` ุฑุง ุงุฌุฑุง ูโฺฉูุฏ ฺฉู ฺฉุงุฑูุง ุฒุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:
   - ุดุฑูุน AVEVA ุจุง macro `RVM.mac`
   - ูุงูุชูุฑูฺฏ ูุฑุขูุฏ ุงุฒ ุทุฑู `RVM_LOG.txt`
   - ุงูุชุธุงุฑ ุชุง ุชููุฏ ูุงู `.nwd`
   - ุญุฐู ุฏุงุฆู ุชูุงู ูุงูโูุง ฺฉูฺฉ ูพุณ ุงุฒ ููููุช ููุง

5. **ุณุณุชู ุชู ู ุชูุธูุงุช ุฐุฎุฑูโุดุฏู:**  
   ูุฑ ุชุบุฑ ุฑูฺฏ ุง ุชู ุฏุฑ `QSettings` ุฐุฎุฑู ูโุดูุฏ ุชุง ุงุฌุฑุง ุจุนุฏ ููุงู ุญุงูุช ุญูุธ ฺฏุฑุฏุฏ.  
   ููฺูู ุฒูุงูโุจูุฏ ู ูุณุช ุขุจุฌฺฉุชโูุง ุจูโุตูุฑุช ุฏุงุฆู ูฺฏูุฏุงุฑ ูโุดููุฏ.

</p>

---

## ๐ ูุญูู ุงุฌุฑุง

### ูพุดโูุงุฒูุง

<p dir="rtl">
ุจุฑุง ุงุฌุฑุง ุจุฑูุงูู ูุงุฒ ุจู ูุตุจ <b>Python 3.x</b> ู <b>PyQt6</b> ุฏุงุฑุฏ.
</p>
```bash
pip install PyQt6
```

### ุงุฌุฑุง ูุณุชูู ุจุง ูพุงุชูู
```bash
python main.py
```



## โ๏ธ ุชูุธูุงุช ู ูุณุฑูุง

<p dir="rtl">

- ูุณุฑ AVEVA E3D:  
  ุจูโุตูุฑุช ูพุดโูุฑุถ `"C:/Program Files (x86)/AVEVA/Everything3D3.1"` ุงุณุชุ ุงูุง ูุงุจู ูุฑุงุด ุงุณุช.



### **- ูุณุฑ ูุงู `objectlist.txt`:**
  .ุงู ูุงู ุชฺฉุณุช ุจุงุฏ ุดูุงูู ุณุงุช ูุง ุงุฒ ุจุฑูุงูู  ุจุงุดุฏ ฺฉู ฺฉุงุฑ ุจุฑ ูุฎูุงูุฏ ุงฺฉุณูพูุฑุช ุจฺฏุฑุฏ  
  ุงฺฏุฑ ุงู ูุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุจุฑูุงูู ุขุจุฌฺฉุชโูุง ุขู ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.  
  ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุงุฒ ูพูู ุฌุงูุจ ูุณุช ูพุดโูุฑุถ ูพุฑูฺู ุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏ.
##   -  ูุงู objectlist (.txt) ุจู ุงู ุตูุฑุช ุจุงุฏ ููุดุชู ุดูุฏ: 

  /U109A:PI  
  /U109A:IN  
  /U109A_EQ  
  /SUPPORT-109A-UTILITY  

- ูุณุฑ ุฎุฑูุฌ:  
  ุจุงุฏ ฺฉ ูููุฏุฑ ูุนุชุจุฑ ุจุง ุฏุณุชุฑุณ ููุดุชู ุจุงุดุฏ.  
  ุชูุงู ูุงูโูุง ุชููุฏ (`settings.json`, `attribute.mac`, `RVM.mac`, `RunE3D.bat`) ุฏุฑ ุงู ูููุฏุฑ ุฐุฎุฑู ูโุดููุฏ.

</p>

---

## ๐ง ูุญูู ุนููฺฉุฑุฏ ุฏุงุฎู

<p dir="rtl">

1. ฺฉุงุฑุจุฑ ูุณุฑูุง ู ุงุทูุงุนุงุช ูพุฑูฺู ุฑุง ุฏุฑ ูุฑู ูุงุฑุฏ ูโฺฉูุฏ.  
2. ูุฑูโุงูุฒุงุฑ ุจุฑ ุงุณุงุณ ูพุฑูฺู (`proj_code`) ู ูุงูโูุง ููุฌูุฏุ ูุณุช ุขุจุฌฺฉุชโูุง ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ.  
3. ูุงูโูุง JSON ู Macro ุณุงุฎุชู ูโุดููุฏ ุจุง ูพุงุฑุงูุชุฑูุง ฺฉุงุฑุจุฑ.  
4. ูุงู `RunE3D.bat` ุงุฌุฑุง ุดุฏู ู ูุฑุขูุฏ ุงฺฉุณูพูุฑุช ุฏุฑ AVEVA ุดุฑูุน ูโุดูุฏ.  
5. Batch ูุงู ูพุณ ุงุฒ ููููุชุ ุชูุงู ูุงูโูุง ูููุช ุฑุง ุญุฐู ูโฺฉูุฏ ู ุชููุง ุฎุฑูุฌ `.nwd` ุจุงู ูโูุงูุฏ.

</p>

---

## ๐ ุณุงุฎุชุงุฑ ูพูุดู ุฎุฑูุฌ ููููู
```
C:/ExportOutput/
โโโ settings.json
โโโ RVM.mac
โโโ attribute.mac
โโโ RunE3D.bat
โโโ RVM_LOG.txt       โ ูุงฺฏ ุงุฌุฑุง ูุฑุขูุฏ
โโโ OUTPUT_MODEL.nwd  โ ูุงู ุฎุฑูุฌ ููุง
```

---

## ๐๏ธ ุชูุธูุงุช ูพุฑูฺูโูุง ูพุดโูุฑุถ

<p dir="rtl">
ุจุฑูุงูู ุงุฒ ูฺฏุงุดุชโูุง (Mapping) ูพุดโูุฑุถ ุจุฑุง ฺฉุฏ ูพุฑูฺูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจู ฺฏูููโุง ฺฉู MDB ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ูพุฑ ุดูุฏ:
</p>

| ฺฉุฏ ูพุฑูฺู | MDB ูพุดโูุฑุถ          |
|-----------|----------------------|
| PAZ       | `/P1-ALL-PLANT`      |
| PBZ       | `/P2-ALL-PLANT`      |
| PCZ       | `/P3-ALL-PLANT`      |
| PEZ       | `/P5-ALL-PLANT-SU`   |
| PFB       | `/ALL-PLANT-P6.2-NEW`|
| PGZ       | `/P7-ALL-PLANT`      |
| PHZ       | `/P8-ALL-PLANT`      |
| PFI       | `/P04-ALL`           |
| PMZ       | `/P12-ALL-PLANT-KHARG`|
| POZ       | `/ALL-PLANT-P13`     |
| PCC       | `/ALL-2140`          |

---

## ๐ค ุชูุณุนูโุฏููุฏู

| ูุดุฎุตู | ุชูุถุญ |
|--------|-------|
| ๐จโ๐ป ูุงู | **Hossein Izadi** |
| โ๏ธ ุงูู | [hossein.pi.ad@gmail.com](mailto:hossein.pi.ad@gmail.com) |
| ๐ ฺฏุชโูุงุจ | [github.com/arkittioe](https://github.com/arkittioe) |
| ๐งฉ ูพุฑูฺู | Export AVEVA E3D to Navisworks |

---

## โก ูฺฉุงุช ุญุฑููโุง

<p dir="rtl">

- ุฏุฑ ุงุณุชูุงุฏู ุงุฒ Python ู PyInstallerุ ุชูุฌู ฺฉูุฏ ฺฉู ูุณุฑูุง ุญุงู ฺฉุงุฑุงฺฉุชุฑ ูุถุง ุฎุงู (`space`) ุจุงุฏ ุจุง ฺฉูุชุดู `"path"` ุฏุฑ Batch Script ุจุณุชู ุดููุฏ.
- ุงฺฏุฑ ูุงู ุฎุฑูุฌ NWD ุณุงุฎุชู ูุดุฏุ ูุงฺฏ `RVM_LOG.txt` ุฑุง ุจุฑุฑุณ ฺฉูุฏ.
- ุจุฑุง ุงุฌุฑุง ุฒูุงูโุจูุฏโุดุฏู ุฑูุฒุงููุ ฺฏุฒูู ยซDaily Exportยป ุฏุฑ ุจุฑูุงูู ูุฌูุฏ ุฏุงุฑุฏ.
- ูโุชูุงูุฏ ูุณุช ุขุจุฌฺฉุชโูุง ุฑุง ุฏุฑ ูพูู ุฌุงูุจ ุฐุฎุฑู ฺฉูุฏุ ุงู ุฏุงุฏูโูุง ุฏุฑ ุญุงูุธู ุฏุงุฆู ุจุงู ูโูุงููุฏ.
- ูุงูโูุง `.mac` ุชููุฏ ุงุฒ syntax ุฑุณู AVEVA Macro ูพุฑู ูโฺฉููุฏ ู ุจุฑุง ุทุฑุงุญ ุฏุงุฎู ูุฏูโูุง ุจููู ุดุฏูโุงูุฏ.

</p>

---

<p dir="rtl" align="center">
ุณุงุฎุชู ุดุฏู ุจุง โค๏ธ ุจุฑุง ูููุฏุณุงู ู ฺฉุงุฑุจุฑุงู ุญุฑููโุง AVEVA ู Navisworks
</p>
